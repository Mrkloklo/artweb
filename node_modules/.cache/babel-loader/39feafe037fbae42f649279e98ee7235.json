{"remainingRequest":"/Users/gujiahao/Documents/work/github/artweb/node_modules/babel-loader/lib/index.js!/Users/gujiahao/Documents/work/github/artweb/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/gujiahao/Documents/work/github/artweb/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gujiahao/Documents/work/github/artweb/src/components/amap.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/gujiahao/Documents/work/github/artweb/src/components/amap.vue","mtime":1588230106466},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/cache-loader/dist/cjs.js","mtime":1579587180818},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/babel-loader/lib/index.js","mtime":1585810045725},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/cache-loader/dist/cjs.js","mtime":1579587180818},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/vue-loader/lib/index.js","mtime":1585810053320}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\nimport Util from '@utils';\nexport default {\n  name: 'AMap',\n  props: {\n    width: {\n      type: [Number, String],\n      default: '100%'\n    },\n    height: {\n      type: [Number, String],\n      default: '270px'\n    },\n    options: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n    complete: Function,\n    error: Function,\n    poicallback: Function\n  },\n  data: function data() {\n    return {\n      setting: {\n        map: {\n          resizeEnable: true\n        },\n        geolocation: {\n          enableHighAccuracy: true,\n          timeout: 10000,\n          buttonOffset: 0,\n          zoomToAccuracy: true,\n          buttonPosition: 'RB'\n        },\n        radius: 1000\n      },\n      position: null\n    };\n  },\n  methods: {\n    /**\n     * 初始化定位\n     * @private\n     */\n    _initializationGeo: function _initializationGeo() {\n      var _this = this;\n\n      var geolocation;\n      var _window = window,\n          AMap = _window.AMap;\n      var setting = this.setting; // 加载地图，调用浏览器定位服务\n\n      var map = new AMap.Map(document.getElementById('amap'), setting.map);\n      map.plugin('AMap.Geolocation', function () {\n        geolocation = new AMap.Geolocation(setting.geolocation);\n        map.addControl(geolocation);\n        geolocation.getCurrentPosition();\n        AMap.event.addListener(geolocation, 'complete', _this._onComplete);\n        AMap.event.addListener(geolocation, 'error', _this._onError);\n      });\n    },\n\n    /**\n     * 定位成功后触发\n     * @param {Object} data 高德地图返回的坐标内容\n     * @private\n     */\n    _onComplete: function _onComplete(data) {\n      this.position = data.position;\n\n      this._coordConvert(this.position);\n\n      data.position = this.position;\n\n      if (this.complete && typeof this.complete === 'function') {\n        this.complete(data);\n      }\n    },\n\n    /**\n     * 定位失败后触发\n     * @param {Object} err 报错信息\n     */\n    _onError: function _onError(err) {\n      if (this.error && typeof this.error === 'function') {\n        this.error(err);\n      }\n    },\n\n    /**\n     * 高德坐标转换成百度坐标\n     * @param {Object} position 坐标位置\n     */\n    _coordConvert: function _coordConvert(position) {\n      var _this2 = this;\n\n      var x = position.lng;\n      var y = position.lat;\n      var _window2 = window,\n          BMap = _window2.BMap;\n      var ggPoint = new BMap.Point(x, y);\n      var convertor = new BMap.Convertor();\n      var pointArr = [];\n      pointArr.push(ggPoint);\n      convertor.translate(pointArr, 3, 5, function (data) {\n        var points = data.points[0];\n        position.lng = points.lng;\n        position.lat = points.lat; // 周边检索\n\n        _this2.searchQuery(position.lng, position.lat);\n      });\n    },\n\n    /**\n     * 周边检索\n     * @param {Object} lng 百度地图的纬度\n     * @param {Object} lat 百度地图的精度\n     */\n    searchQuery: function searchQuery(lng, lat) {\n      Util.loaderLibrary({\n        src: \"//api.map.baidu.com/geocoder/v2/?callback=_addrFrameCallback&location=\".concat(lat, \",\").concat(lng, \"&output=json&pois=1&ak=K5LXDCfHLnGvLDQsZx0AKyXNV5kLObYF&radius=\").concat(this.setting.radius),\n        type: 'js',\n        inject: 'body'\n      });\n    }\n  },\n  created: function created() {\n    var _this3 = this;\n\n    this.setting = Object.assign(this.setting, this.options);\n    Util.loaderLibrary({\n      src: '//webapi.amap.com/maps?v=1.4.6&key=f2cb2852df505ce99f414bff0b93915b',\n      type: 'js',\n      inject: 'head'\n    }, {\n      src: '//api.map.baidu.com/getscript?v=2.0&ak=K5LXDCfHLnGvLDQsZx0AKyXNV5kLObYF&services=&t=20190123111209',\n      type: 'js',\n      inject: 'head'\n    }).then(function () {\n      _this3.setting.geolocation.buttonOffset = new window.AMap.Pixel(10, 20);\n\n      _this3._initializationGeo();\n    });\n\n    window._addrFrameCallback = function (data) {\n      if (_this3.poicallback && typeof _this3.poicallback === 'function') {\n        _this3.poicallback(data);\n      }\n    };\n  }\n};",{"version":3,"sources":["amap.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"amap\" id=\"amap\" ref=\"map\" :style=\"{width: width, height: `${parseInt(height)}px`}\"></div>\n</template>\n\n<script>\nimport Util from '@utils';\n\nexport default {\n  name: 'AMap',\n  props: {\n    width: {\n      type: [Number, String],\n      default: '100%'\n    },\n    height: {\n      type: [Number, String],\n      default: '270px'\n    },\n    options: {\n      type: Object,\n      default () {\n        return {};\n      }\n    },\n    complete: Function,\n    error: Function,\n    poicallback: Function\n  },\n  data () {\n    return {\n      setting: {\n        map: {\n          resizeEnable: true\n        },\n        geolocation: {\n          enableHighAccuracy: true,\n          timeout: 10000,\n          buttonOffset: 0,\n          zoomToAccuracy: true,\n          buttonPosition: 'RB'\n        },\n        radius: 1000\n      },\n      position: null\n    };\n  },\n  methods: {\n    /**\n     * 初始化定位\n     * @private\n     */\n    _initializationGeo () {\n      let geolocation;\n      const { AMap } = window;\n      const { setting } = this;\n\n      // 加载地图，调用浏览器定位服务\n      const map = new AMap.Map(document.getElementById('amap'), setting.map);\n\n      map.plugin('AMap.Geolocation', () => {\n        geolocation = new AMap.Geolocation(setting.geolocation);\n\n        map.addControl(geolocation);\n        geolocation.getCurrentPosition();\n        AMap.event.addListener(geolocation, 'complete', this._onComplete);\n        AMap.event.addListener(geolocation, 'error', this._onError);\n      });\n    },\n\n    /**\n     * 定位成功后触发\n     * @param {Object} data 高德地图返回的坐标内容\n     * @private\n     */\n    _onComplete (data) {\n      this.position = data.position;\n      this._coordConvert(this.position);\n      data.position = this.position;\n      if (this.complete && typeof this.complete === 'function') {\n        this.complete(data);\n      }\n    },\n\n    /**\n     * 定位失败后触发\n     * @param {Object} err 报错信息\n     */\n    _onError (err) {\n      if (this.error && typeof this.error === 'function') {\n        this.error(err);\n      }\n    },\n\n    /**\n     * 高德坐标转换成百度坐标\n     * @param {Object} position 坐标位置\n     */\n    _coordConvert (position) {\n      const x = position.lng;\n      const y = position.lat;\n      const { BMap } = window;\n      const ggPoint = new BMap.Point(x, y);\n      const convertor = new BMap.Convertor();\n      const pointArr = [];\n\n      pointArr.push(ggPoint);\n      convertor.translate(pointArr, 3, 5, (data) => {\n        const points = data.points[0];\n\n        position.lng = points.lng;\n        position.lat = points.lat;\n        // 周边检索\n        this.searchQuery(position.lng, position.lat);\n      });\n    },\n\n    /**\n     * 周边检索\n     * @param {Object} lng 百度地图的纬度\n     * @param {Object} lat 百度地图的精度\n     */\n    searchQuery (lng, lat) {\n      Util.loaderLibrary({\n        src: `//api.map.baidu.com/geocoder/v2/?callback=_addrFrameCallback&location=${lat},${lng}&output=json&pois=1&ak=K5LXDCfHLnGvLDQsZx0AKyXNV5kLObYF&radius=${this.setting.radius}`,\n        type: 'js',\n        inject: 'body'\n      });\n    }\n  },\n  created () {\n    this.setting = Object.assign(this.setting, this.options);\n\n    Util.loaderLibrary({\n      src: '//webapi.amap.com/maps?v=1.4.6&key=f2cb2852df505ce99f414bff0b93915b',\n      type: 'js',\n      inject: 'head'\n    }, {\n      src: '//api.map.baidu.com/getscript?v=2.0&ak=K5LXDCfHLnGvLDQsZx0AKyXNV5kLObYF&services=&t=20190123111209',\n      type: 'js',\n      inject: 'head'\n    }).then(() => {\n      this.setting.geolocation.buttonOffset = new window.AMap.Pixel(10, 20);\n      this._initializationGeo();\n    });\n\n    window._addrFrameCallback = (data) => {\n      if (this.poicallback && typeof this.poicallback === 'function') {\n        this.poicallback(data);\n      }\n    };\n  }\n};\n</script>\n\n<style scoped>\n\n</style>\n"],"sourceRoot":"src/components"}]}