{"remainingRequest":"/Users/gujiahao/Documents/work/github/artweb/node_modules/thread-loader/dist/cjs.js!/Users/gujiahao/Documents/work/github/artweb/node_modules/babel-loader/lib/index.js!/Users/gujiahao/Documents/work/github/artweb/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/gujiahao/Documents/work/github/artweb/public/ejs/v2/epoint.moapi.v2.dd.js","dependencies":[{"path":"/Users/gujiahao/Documents/work/github/artweb/public/ejs/v2/epoint.moapi.v2.dd.js","mtime":1588230106434},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/cache-loader/dist/cjs.js","mtime":1579587180818},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/thread-loader/dist/cjs.js","mtime":1579587183081},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/babel-loader/lib/index.js","mtime":1585810045725},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1579587173378}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _typeof from \"/Users/gujiahao/Documents/work/github/artweb/node_modules/@babel/runtime-corejs2/helpers/esm/typeof\";\n\n/**\n * 作者: guotq\n * 创建时间: 2016/12/06\n * 版本: [1.0, 2017/05/25 ]\n * 版权: 江苏国泰新点软件有限公司\n * 描述: ejs 2.1系列API在dd环境下的部分实现\n * 目前只实现了部分api\n * 请先引入ejsv2核心文件\n * 实现的模块有:\n * nativeUI模块\n * navigator部分功能\n * ddComponent 钉钉平台下独特的一些api\n */\n\n/**\n * 拓展ejs在钉钉下的api\n * 所有参数和ejs保持一致就行了\n */\nejs.extendFucObj('nativeUI', {\n  'toast': function toast(options) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    var msg = '';\n    options = options || {};\n\n    if (typeof options === 'string') {\n      msg = options;\n    } else {\n      msg = options.message;\n    }\n\n    dd.device.notification.toast({\n      icon: '',\n      //icon样式，有success和error，默认为空 0.0.2\n      text: msg || '',\n      //提示信息\n      duration: 2,\n      //显示持续时间，单位秒，默认按系统规范[android只有两种(<=2s >2s)]\n      delay: 0,\n      //延迟显示，单位秒，默认0\n      onSuccess: function onSuccess(result) {\n        /*{}*/\n      },\n      onFail: function onFail(err) {}\n    });\n  },\n  //callback目前只有钉钉中有用\n  'alert': function alert(options, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    var title = '',\n        msg = '',\n        btn = '';\n    options = options || {};\n\n    if (typeof options === 'string') {\n      msg = options;\n      title = arguments[1] || '';\n      btn = arguments[2] || '';\n      callback = arguments[3] || null;\n    } else {\n      msg = options.message;\n      title = options.title;\n      btn = options.btn;\n    }\n\n    msg = msg || '';\n    title = title || \"提示\";\n    btn = btn || '确定';\n    dd.device.notification.alert({\n      message: msg,\n      title: title,\n      //可传空\n      buttonName: btn,\n      onSuccess: function onSuccess() {\n        //onSuccess将在点击button之后回调\n\n        /*回调*/\n        callback && callback();\n      },\n      onFail: function onFail(err) {\n        error && error();\n      }\n    });\n  },\n  'confirm': function confirm(options, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    options = options || {};\n\n    if (typeof options === 'string') {\n      options = {\n        'message': options\n      };\n\n      if (typeof arguments[1] === 'string') {\n        options.title = arguments[1];\n\n        if (_typeof(arguments[2]) === 'object') {\n          btnArray = arguments[2];\n          callback = arguments[3];\n        } else {\n          callback = arguments[2];\n        }\n      }\n    }\n\n    var msg = options.message || '';\n    var title = options.title || \"提示\";\n    var btnArray = [];\n    var btn1 = options.btn1 || '取消';\n    var btn2 = options.btn2 || (options.btn2 !== null ? '确定' : '');\n    btn1 && btnArray.push(btn1);\n    btn2 && btnArray.push(btn2);\n    dd.device.notification.confirm({\n      message: msg,\n      title: title,\n      buttonLabels: btnArray,\n      onSuccess: function onSuccess(result) {\n        //onSuccess将在点击button之后回调\n\n        /*\n        {\n            buttonIndex: 0 //被点击按钮的索引值，Number类型，从0开始\n        }\n        */\n        var index = -1 * (result.buttonIndex + 1);\n        var res = {\n          'code': 1,\n          'msg': '',\n          'result': {\n            \"which\": index\n          },\n          'detail': result\n        };\n        callback && callback(res.result, res.msg, res);\n      },\n      onFail: function onFail(err) {}\n    });\n  },\n  //ejs下暂时没有title与options属性这个属性\n  //padlock  点击自动关闭--目前只有这个兼容h5版本\n  'showWaiting': function showWaiting(title, options) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    title = title || '';\n    options = options || {};\n    dd.device.notification.showPreloader({\n      text: title || \"等待中...\",\n      //loading显示的字符，空表示不显示文字\n      showIcon: true,\n      //是否显示icon，默认true\n      onSuccess: function onSuccess() {\n        /*{}*/\n      },\n      onFail: function onFail(err) {}\n    });\n  },\n  'closeWaiting': function closeWaiting() {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    dd.device.notification.hidePreloader({\n      onSuccess: function onSuccess(result) {\n        /*{}*/\n      },\n      onFail: function onFail(err) {}\n    });\n  },\n  'actionSheet': function actionSheet(options, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    options = options || {};\n    options.items = options.items || [];\n    var title = options.title || '';\n    dd.device.notification.actionSheet({\n      title: title,\n      //标题\n      cancelButton: '取消',\n      //取消按钮文本\n      otherButtons: options.items,\n      onSuccess: function onSuccess(result) {\n        //onSuccess将在点击button之后回调\n\n        /*{\n            buttonIndex: 0 //被点击按钮的索引值，Number，从0开始, 取消按钮为-1\n        }*/\n        var index = result.buttonIndex;\n        var content = options.items[index];\n        var res = {\n          'code': 1,\n          'msg': '',\n          'result': {\n            \"which\": index,\n            \"content\": content\n          }\n        };\n        callback && callback(res.result, res.msg, res);\n      },\n      onFail: function onFail(err) {\n        error && error();\n      }\n    });\n  }\n});\n/**\n * 拓展  navigator 模块\n */\n\nejs.extendFucObj('navigator', {\n  'setTitle': function setTitle(title) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    title = title || '';\n    dd.biz.navigation.setTitle({\n      title: title,\n      //控制标题文本，空字符串表示显示默认文本\n      onSuccess: function onSuccess(result) {},\n      onFail: function onFail(err) {}\n    });\n  },\n  'setRightTextBtn': function setRightTextBtn(title, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    title = title || '';\n    dd.biz.navigation.setRight({\n      show: title ? true : false,\n      //控制按钮显示， true 显示， false 隐藏， 默认true\n      control: callback ? true : false,\n      //是否控制点击事件，true 控制，false 不控制， 默认false\n      text: title || '',\n      //控制显示文本，空字符串表示显示默认文本\n      onSuccess: function onSuccess(result) {\n        //如果control为true，则onSuccess将在发生按钮点击事件被回调\n\n        /*\n        {}\n        */\n        callback && callback(result);\n      },\n      onFail: function onFail(err) {//设置按钮失败，可以提示\n      }\n    });\n  },\n  // ejs中是用popwindow来实现\n  'setRightMenu': function setRightMenu(backgroundColor, items, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    dd.biz.navigation.setMenu({\n      backgroundColor: backgroundColor,\n      items: items,\n      onSuccess: function onSuccess(data) {\n        callback && callback(data);\n      },\n      onFail: function onFail(err) {}\n    });\n  }\n});\n/**\n * 拓展dd特有的api\n * 这种API只适合与钉钉平台 \n */\n\nejs.extendFucObj('ddComponent', {\n  /**\n   * @description 选择通讯录,将一些逻辑都封装起来,简化使用\n   * @param {JSON} options 选项\n   * @param {Function} callback 回调函数\n   */\n  'chooseContactPerson': function chooseContactPerson(options, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    ejs.nativeUI.actionSheet({\n      'title': '打开类别',\n      'items': ['整个公司选择', '本部门选择']\n    }, function (result) {\n      var index = result.which;\n\n      if (index === -1) {\n        return;\n      } //默认为整个公司选择\n\n\n      var type = 0;\n\n      if (index === 1) {\n        //部门选择\n        type = -1;\n      }\n\n      dd.biz.contact.choose({\n        //默认要整个公司进行选择\n        startWithDepartmentId: type,\n        //-1表示打开的通讯录从自己所在部门开始展示, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)\n        multiple: true,\n        //是否多选： true多选 false单选； 默认true\n        users: options.userGuidList,\n        //默认选中的用户列表，userid；成功回调中应包含该信息\n        corpId: options.corpId,\n        //企业id\n        max: options.currMaxChooseCount,\n        //人数限制，当multiple为true才生效，可选范围1-1500\n        onSuccess: function onSuccess(data) {\n          //onSuccess将在选人结束，点击确定按钮的时候被回调\n\n          /* data结构\n            [{\n              \"name\": \"张三\", //姓名\n              \"avatar\": \"http://g.alicdn.com/avatar/zhangsan.png\" //头像图片url，可能为空\n              \"emplId\": '0573', //userid\n             },\n             ...\n            ]\n          */\n          callback && callback(data);\n        },\n        onFail: function onFail(err) {}\n      });\n    });\n  },\n\n  /**\n   * @description 将文件转存到钉盘\n   * @param {JSON} options 选项\n   * @param {Function} callback 回调函数\n   */\n  'saveFileToDP': function saveFileToDP(options, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    options = options || {};\n    dd.biz.cspace.saveFile({\n      corpId: options.corpId,\n      url: options.url,\n      name: options.name || '匿名文件',\n      onSuccess: function onSuccess(data) {\n        /* data结构\n        {\"data\":\n           [\n           {\n           \"corpId\": \"\", //公司id\n           \"spaceId\": \"\" //空间id\n           \"fileId\": \"\", //文件id\n           \"fileName\": \"\", //文件名\n           \"fileSize\": 111111, //文件大小\n           \"fileType\": \"\", //文件类型\n           }\n           ]\n        }\n        */\n        ejs.nativeUI.toast('转到钉盘成功');\n        callback && callback(data);\n      },\n      onFail: function onFail(err) {\n        ejs.nativeUI.toast('转到钉盘失败...');\n      }\n    });\n  },\n\n  /**\n   * @description 钉住,发钉,不是钉盘\n   * @param {JSON} options\n   * @param {Function} callback\n   */\n  'postDing': function postDing(options, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    options = options || {};\n    dd.biz.ding.post({\n      //用户列表，默认为用户自己\n      users: options.users,\n      corpId: options.corpId,\n      //企业id\n      type: options.type,\n      //钉类型 1：image  2：link\n      alertType: options.alertType || 2,\n      alertDate: options.alertDate,\n      attachment: options.attachment,\n      text: options.text,\n      //消息\n      onSuccess: function onSuccess() {\n        callback && callback();\n      },\n      onFail: function onFail() {}\n    });\n  },\n\n  /**\n   * @description 上传拍照图片，可以得到照片\n   * @param {JSON} options\n   * @param {Function} callback\n   */\n  'uploadImageFromCamera': function uploadImageFromCamera(options, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    options = options || {};\n    dd.biz.util.uploadImageFromCamera({\n      compression: options.compression,\n      //(是否压缩，默认为true)\n      onSuccess: function onSuccess(result) {\n        callback && callback(result); //onSuccess将在图片上传成功之后调用\n\n        /*\n        [\n          'http://gtms03.alicdn.com/tps/i3/TB1VF6uGFXXXXalaXXXmh5R_VXX-237-236.png'\n        ]\n        */\n      },\n      onFail: function onFail() {}\n    });\n  },\n\n  /**\n   * @description 上传相册，可以得到照片\n   * @param {JSON} options\n   * @param {Function} callback\n   */\n  'uploadImage': function uploadImage(options, callback) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    options = options || {};\n    dd.biz.util.uploadImage({\n      multiple: options.multiple,\n      //是否多选，默认false\n      max: options.max,\n      //最多可选个数\n      onSuccess: function onSuccess(result) {\n        callback && callback(result); //onSuccess将在图片上传成功之后调用\n\n        /*\n        [\n          'http://gtms03.alicdn.com/tps/i3/TB1VF6uGFXXXXalaXXXmh5R_VXX-237-236.png'\n        ]\n        */\n      },\n      onFail: function onFail() {}\n    });\n  },\n\n  /**\n   * @description 处理附件，是决定用钉盘还是下载\n   * @param {JSON} options 参数\n   */\n  dealWithAttachFile: function dealWithAttachFile(options) {\n    if (!ejs.os.dd) {\n      // 只有dd中才能使用\n      return;\n    }\n\n    options = options || {};\n    var url = options.url || '';\n    var name = options.name || '';\n    var corpId = options.corpId || '';\n    var itemsArray = ['转到钉盘', '直接下载'];\n\n    if (CommonTools.os.ios) {\n      //iOS下只支持rar,zip的下载\n      if (url.toLowerCase().indexOf('.zip') === -1 && url.toLowerCase().indexOf('.rar') === -1) {\n        itemsArray.splice(1, 1);\n      }\n    }\n\n    ejs.nativeUI.actionSheet({\n      'title': '选择',\n      'items': itemsArray\n    }, function (result) {\n      var index = result.which;\n\n      if (index === 0) {\n        //url = 'http://218.4.136.114:7009/EpointMobilePlatform6/test.xlsx';\n        ejs.ddComponent.saveFileToDP({\n          corpId: corpId,\n          url: url,\n          name: name\n        });\n      } else if (index === 1) {\n        window.location.href = url;\n      }\n    });\n  }\n});\n/**\n * 单独覆盖一些已有的esj api 和拓展模式有区别\n * 比如openPage需要重新改写逻辑\n * 目前只支持单个覆盖\n * 目前不会自动暴露出去，只会覆盖已有\n */\n\n(function () {\n  var oldOpenPage = ejs.page.openPage; // 覆盖openPage,默认关闭钉钉中的分享\n\n  ejs.extendFuc('page', 'openPage', function (url, title, jsonObj, options, callback, error) {\n    jsonObj = jsonObj || {};\n    options = options || {};\n    url = ejs.app.appendParams(url, jsonObj);\n\n    if (ejs.os.dd) {\n      if (url.indexOf('?') === -1) {\n        url += '?';\n      } else {\n        url += '&';\n      }\n\n      url += 'dd_share=false';\n      console.log(\"url:\" + url);\n      document.location.href = url;\n    } else {\n      oldOpenPage(url, title, jsonObj, options, callback, error);\n    }\n  }, true);\n})();",null]}