{"remainingRequest":"/Users/gujiahao/Documents/work/github/artweb/node_modules/babel-loader/lib/index.js!/Users/gujiahao/Documents/work/github/artweb/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/gujiahao/Documents/work/github/artweb/src/utils/request.js","dependencies":[{"path":"/Users/gujiahao/Documents/work/github/artweb/src/utils/request.js","mtime":1588230106653},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/cache-loader/dist/cjs.js","mtime":1579587180818},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/babel-loader/lib/index.js","mtime":1585810045725},{"path":"/Users/gujiahao/Documents/work/github/artweb/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1579587173378}],"contextDependencies":[],"result":["import \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport axios from 'axios';\nimport Config from '@shared/config';\nimport Util from \"./index\";\nimport qs from 'qs';\nvar defaultSettings = {\n  type: 'post',\n  url: '',\n  data: '',\n  dataType: 'json',\n  timeout: 10000,\n  headers: {},\n  contentType: 'application/x-www-form-urlencoded',\n  withCredentials: false,\n  delay: 0,\n  isAutoProxy: Config.ajax.isAutoProxy,\n  baseURL: '',\n  transformRequest: [],\n  transformResponse: [],\n  paramsSerializer: null,\n  adapter: null,\n  params: null,\n  xsrfCookieName: '',\n  xsrfHeaderName: '',\n  uploading: function uploading(progressEvent) {},\n  downloading: function downloading(progressEvent) {},\n  maxContentLength: 2000,\n  validateStatus: null,\n  auth: null,\n  proxy: null,\n  error: function error() {},\n  complete: function complete() {}\n};\nvar params = {};\nvar ejsVer = Config.ejsVer;\n\nvar setHeader = function setHeader(key, value) {\n  var _params = params,\n      headers = _params.headers;\n  headers[key] = value;\n};\n\nvar createInterceptors = function createInterceptors() {\n  axios.interceptors.request.use(function (config) {\n    // 判断是否存在token，如果存在的话，则每个http header都加上token\n    if (ejsVer === 3 && Util.os.ejs) {\n      ejs.auth.getToken({\n        success: function success(result) {\n          config.headers.Authorization = \"Bearer \".concat(result.access_token);\n        }\n      });\n    } else if (ejsVer === 3) {\n      config.withCredentials = true;\n    }\n\n    return config;\n  }, function (error) {\n    return Promise.reject(error);\n  });\n};\n\nfunction ajax(options) {\n  options = Util.extend(defaultSettings, options);\n  params = {\n    url: options.url,\n    method: options.type,\n    data: options.data,\n    headers: options.headers,\n    baseURL: options.baseURL,\n    responseType: options.dataType,\n    withCredentials: options.withCredentials,\n    transformRequest: options.transformRequest,\n    transformResponse: options.transformResponse,\n    params: options.params,\n    paramsSerializer: options.paramsSerializer,\n    timeout: options.timeout,\n    adapter: options.adapter,\n    auth: options.auth,\n    onUploadProgress: options.uploading,\n    onDownloadProgress: options.downloading,\n    maxContentLength: options.maxContentLength,\n    validateStatus: options.validateStatus,\n    proxy: options.proxy\n  };\n  var _options = options,\n      delay = _options.delay,\n      contentType = _options.contentType,\n      headers = _options.headers,\n      isAutoProxy = _options.isAutoProxy,\n      error = _options.error,\n      success = _options.success,\n      complete = _options.complete,\n      beforeSend = _options.beforeSend; // 设置重试延迟\n\n  axios.defaults.retryDelay = delay;\n\n  for (var key in headers) {\n    setHeader(key, headers[key]);\n  }\n\n  if (contentType) {\n    setHeader('Content-Type', contentType);\n\n    if (contentType === 'application/x-www-form-urlencoded; charset=UTF-8' || contentType === 'application/x-www-form-urlencoded') {\n      params.data = qs.stringify(options.data);\n    }\n  }\n\n  if (isAutoProxy) {\n    // 创建拦截器\n    createInterceptors();\n  }\n\n  if (typeof beforeSend === 'function') {\n    beforeSend(axios);\n  }\n\n  if (typeof success !== 'function') {\n    return axios(params);\n  } else {\n    axios(params).then(function (response) {\n      var status = response.status,\n          statusText = response.statusText,\n          data = response.data;\n\n      if (status !== 200 && statusText !== 'OK' || typeof data.errcode === 'number') {\n        error(data);\n\n        if (Config.ajax.isAutoErrToast) {\n          _Toast(data.errmsg);\n        }\n      } else {\n        success(data, response);\n      }\n    }).catch(function (err) {\n      error(err);\n    }).then(function () {\n      complete();\n    });\n  }\n}\n\nfunction ajaxAll() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  return axios.all(args);\n}\n\nexport { ajax, ajaxAll };",{"version":3,"sources":["/Users/gujiahao/Documents/work/github/artweb/src/utils/request.js"],"names":["axios","Config","Util","qs","defaultSettings","type","url","data","dataType","timeout","headers","contentType","withCredentials","delay","isAutoProxy","ajax","baseURL","transformRequest","transformResponse","paramsSerializer","adapter","params","xsrfCookieName","xsrfHeaderName","uploading","progressEvent","downloading","maxContentLength","validateStatus","auth","proxy","error","complete","ejsVer","setHeader","key","value","createInterceptors","interceptors","request","use","config","os","ejs","getToken","success","result","Authorization","access_token","Promise","reject","options","extend","method","responseType","onUploadProgress","onDownloadProgress","beforeSend","defaults","retryDelay","stringify","then","response","status","statusText","errcode","isAutoErrToast","errmsg","catch","err","ajaxAll","args","all"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport Config from '@shared/config';\nimport {\n  Toast\n} from 'vant';\nimport Util from './index';\nimport qs from 'qs';\n\nconst defaultSettings = {\n  type: 'post',\n  url: '',\n  data: '',\n  dataType: 'json',\n  timeout: 10000,\n  headers: {},\n  contentType: 'application/x-www-form-urlencoded',\n  withCredentials: false,\n  delay: 0,\n  isAutoProxy: Config.ajax.isAutoProxy,\n  baseURL: '',\n  transformRequest: [],\n  transformResponse: [],\n  paramsSerializer: null,\n  adapter: null,\n  params: null,\n  xsrfCookieName: '',\n  xsrfHeaderName: '',\n  uploading: function (progressEvent) {},\n  downloading: function (progressEvent) {},\n  maxContentLength: 2000,\n  validateStatus: null,\n  auth: null,\n  proxy: null,\n  error: () => {},\n  complete: () => {}\n};\n\nlet params = {};\nconst ejsVer = Config.ejsVer;\nconst setHeader = function (key, value) {\n  const {\n    headers\n  } = params;\n\n  headers[key] = value;\n};\nconst createInterceptors = function () {\n  axios.interceptors.request.use((config) => {\n    // 判断是否存在token，如果存在的话，则每个http header都加上token\n    if (ejsVer === 3 && Util.os.ejs) {\n      ejs.auth.getToken({\n        success: (result) => {\n          config.headers.Authorization = `Bearer ${result.access_token}`;\n        }\n      });\n    } else if (ejsVer === 3) {\n      config.withCredentials = true;\n    }\n\n    return config;\n  }, (error) => Promise.reject(error));\n};\n\nfunction ajax(options) {\n  options = Util.extend(defaultSettings, options);\n  params = {\n    url: options.url,\n    method: options.type,\n    data: options.data,\n    headers: options.headers,\n    baseURL: options.baseURL,\n    responseType: options.dataType,\n    withCredentials: options.withCredentials,\n    transformRequest: options.transformRequest,\n    transformResponse: options.transformResponse,\n    params: options.params,\n    paramsSerializer: options.paramsSerializer,\n    timeout: options.timeout,\n    adapter: options.adapter,\n    auth: options.auth,\n    onUploadProgress: options.uploading,\n    onDownloadProgress: options.downloading,\n    maxContentLength: options.maxContentLength,\n    validateStatus: options.validateStatus,\n    proxy: options.proxy\n  };\n\n  const {\n    delay,\n    contentType,\n    headers,\n    isAutoProxy,\n    error,\n    success,\n    complete,\n    beforeSend\n  } = options;\n\n  // 设置重试延迟\n  axios.defaults.retryDelay = delay;\n\n  for (const key in headers) {\n    setHeader(key, headers[key]);\n  }\n\n  if (contentType) {\n    setHeader('Content-Type', contentType);\n    if (contentType === 'application/x-www-form-urlencoded; charset=UTF-8' || contentType === 'application/x-www-form-urlencoded') {\n      params.data = qs.stringify(options.data);\n    }\n  }\n\n  if (isAutoProxy) {\n    // 创建拦截器\n    createInterceptors();\n  }\n\n  if (typeof beforeSend === 'function') {\n    beforeSend(axios);\n  }\n\n  if (typeof success !== 'function') {\n    return axios(params);\n  } else {\n    axios(params).then((response) => {\n      const {\n        status,\n        statusText,\n        data\n      } = response;\n\n      if ((status !== 200 && statusText !== 'OK') || typeof data.errcode === 'number') {\n        error(data);\n\n        if (Config.ajax.isAutoErrToast) {\n          Toast(data.errmsg);\n        }\n      } else {\n        success(data, response);\n      }\n    }).catch((err) => {\n      error(err);\n    }).then(() => {\n      complete();\n    });\n  }\n}\n\nfunction ajaxAll(...args) {\n  return axios.all(args);\n}\n\nexport {\n  ajax,\n  ajaxAll\n};\n"]}]}